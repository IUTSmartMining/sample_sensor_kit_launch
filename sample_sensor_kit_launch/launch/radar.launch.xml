<launch>
    <arg name="launch_driver" default="true"/>
    <arg name="ip_address" default="192.168.100.95" />
    <arg name="port" default="50000" />
    <arg name="can_tx" default="/sensing/radar/can_tx"/>
    <arg name="objects_raw" default="/sensing/radar/objects_raw"/>
    <arg name="scan" default="/sensing/radar/scan"/>
    <arg name="noise_tracks" default="/sensing/radar/noise_tracks"/>
    <arg name="filtered_objects" default="/sensing/radar/filtered_objects"/>
    <arg name="detected_objects" default="/sensing/radar/detected_objects"/>
    <arg name="tracked_objects" default="/sensing/radar/tracked_objects"/>

    <arg name="noise_objects" default="/perception/radar/noise_objects"/>
    <arg name="noise_filtered_objects" default="/perception/radar/noise_filtered_objects"/>
    <arg name="low_speed_objects" default="/perception/radar/low_speed_objects"/>
    <arg name="high_speed_objects" default="/perception/radar/high_speed_objects"/>
    <arg name="far_high_speed_objects" default="/perception/radar/far_high_speed_objects"/>
    <arg name="near_high_speed_objects" default="/perception/radar/near_high_speed_objects"/>

    <group if="$(var launch_driver)">
        <push-ros-namespace namespace="radar"/>

        <include file="$(find-pkg-share pe_ars408_ros)/launch/continental_ars408.launch.xml">
            <arg name="ip_address" value="$(var ip_address)"/>
            <arg name="port" value="$(var port)"/>
            <arg name="input/frame" value="$(var can_tx)"/>
            <arg name="output/objects" value="$(var objects_raw)"/>
            <arg name="output/scan" value="$(var scan)"/>
        </include>

        <include file="$(find-pkg-share radar_tracks_noise_filter)/launch/radar_tracks_noise_filter.launch.xml">
            <arg name="input/tracks" value="$(var objects_raw)"/>
            <arg name="output/noise_tracks" value="$(var noise_tracks)"/>
            <arg name="output/filtered_tracks" value="$(var filtered_objects)"/>
            <arg name="param_path" value="$(find-pkg-share radar_tracks_noise_filter)/config/radar_tracks_noise_filter.param.yaml"/>
        </include>

        <include file="$(find-pkg-share radar_tracks_msgs_converter)/launch/radar_tracks_msgs_converter.launch.xml">
            <arg name="input/radar_objects" value="$(var filtered_objects)"/>
            <arg name="output/radar_detected_objects" value="$(var detected_objects)"/>
            <arg name="output/radar_tracked_objects" value="$(var tracked_objects)"/>
            <arg name="param_path" value="$(find-pkg-share radar_tracks_msgs_converter)/config/radar_tracks_msgs_converter.param.yaml"/>
        </include>

        <include file="$(find-pkg-share radar_crossing_objects_noise_filter)/launch/radar_crossing_objects_noise_filter.launch.xml">
            <arg name="input/objects" value="$(var detected_objects)"/>
            <arg name="output/noise_objects" value="$(var noise_objects)"/>
            <arg name="output/filtered_objects" value="$(var noise_filtered_objects)"/>
            <arg name="param_path" value="$(find-pkg-share radar_crossing_objects_noise_filter)/config/radar_crossing_objects_noise_filter.param.yaml"/>
        </include>

        <include file="$(find-pkg-share object_velocity_splitter)/launch/object_velocity_splitter.launch.xml">
            <arg name="input/objects" value="$(var noise_filtered_objects)"/>
            <arg name="output/low_speed_objects" value="$(var low_speed_objects)"/>
            <arg name="output/high_speed_objects" value="$(var high_speed_objects)"/>
            <arg name="param_path" value="$(find-pkg-share object_velocity_splitter)/config/object_velocity_splitter.param.yaml"/>
        </include>

        <include file="$(find-pkg-share object_range_splitter)/launch/object_range_splitter.launch.xml">
            <arg name="input/object" value="$(var high_speed_objects)"/>
            <arg name="output/long_range_object" value="$(var far_high_speed_objects)"/>
            <arg name="output/short_range_object" value="$(var near_high_speed_objects)"/>
            <arg name="param_path" value="$(find-pkg-share object_range_splitter)/config/object_range_splitter.param.yaml"/>
        </include>
    </group>

</launch>
